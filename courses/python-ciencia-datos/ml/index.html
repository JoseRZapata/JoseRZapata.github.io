<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jose R. Zapata">

  
  
  
    
  
  <meta name="description" content="Libreria de machine Learning que incluye varios algoritmos de clasificación, regresión y análisis de grupos, ademas de herramientas para seleccion, evaluacion de modelos.">

  
  <link rel="alternate" hreflang="en-us" href="https://joserzapata.github.io/courses/python-ciencia-datos/ml/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#328cc1">
  

  
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.min.d2fb0c56d90ec8195706c5f21055c1e7.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112535090-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-112535090-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  


  
  

  
  <link rel="alternate" href="/courses/python-ciencia-datos/ml/index.xml" type="application/rss+xml" title="Jose Ricardo Zapata">
  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_huef99ce4a8cdef83a01a57b9c8063a4d3_108982_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_huef99ce4a8cdef83a01a57b9c8063a4d3_108982_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://joserzapata.github.io/courses/python-ciencia-datos/ml/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@joserzapata">
  <meta property="twitter:creator" content="@joserzapata">
  
  <meta property="og:site_name" content="Jose Ricardo Zapata">
  <meta property="og:url" content="https://joserzapata.github.io/courses/python-ciencia-datos/ml/">
  <meta property="og:title" content="Machine Learning con Scikit Learn | Jose Ricardo Zapata">
  <meta property="og:description" content="Libreria de machine Learning que incluye varios algoritmos de clasificación, regresión y análisis de grupos, ademas de herramientas para seleccion, evaluacion de modelos."><meta property="og:image" content="https://joserzapata.github.io/img/JoseRZapata.jpg">
  <meta property="twitter:image" content="https://joserzapata.github.io/img/JoseRZapata.jpg"><meta property="og:locale" content="en-us">
  
    <meta property="og:updated_time" content="2020-09-09T00:00:00&#43;00:00">
  

  




  


  





  <title>Machine Learning con Scikit Learn | Jose Ricardo Zapata</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
    <script>window.wcDarkLightEnabled = true;</script>
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="/js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Jose Ricardo Zapata</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Jose Ricardo Zapata</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/phd"><span>Phd Thesis</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  
  
    
    

    
    
  </nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#pasos-para-la-construccion-y-seleccion-de-un-modelo-de-machine-learning">Pasos para la construccion y seleccion de un Modelo de Machine Learning</a></li>
  </ul>

  <ul>
    <li><a href="#standardizacion">Standardizacion</a></li>
    <li><a href="#normalizacion">Normalizacion</a></li>
    <li><a href="#binarizacion">Binarizacion</a></li>
    <li><a href="#encoding-categorical-features">Encoding Categorical Features</a></li>
    <li><a href="#imputacion-de-valores-faltantes">Imputacion de valores Faltantes</a></li>
    <li><a href="#generacion-de-caracteristicas-polinomiales">Generacion de Caracteristicas Polinomiales</a></li>
    <li><a href="#division-datos-de-entrenamiento-y-prueba">Division datos de Entrenamiento y Prueba</a></li>
  </ul>

  <ul>
    <li><a href="#estimadores-aprendizaje-supervisado">Estimadores Aprendizaje Supervisado</a>
      <ul>
        <li><a href="#regresion">Regresion</a></li>
        <li><a href="#clasificacion">Clasificacion</a></li>
      </ul>
    </li>
    <li><a href="#estimadores-de-aprendizaje-no-supervizado">Estimadores de Aprendizaje No supervizado</a>
      <ul>
        <li><a href="#principal-component-analysis-pca">Principal Component Analysis (PCA)</a></li>
        <li><a href="#k-means">K Means</a></li>
        <li><a href="#hierarchical">Hierarchical</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#aprendizaje-supervisado">Aprendizaje Supervisado</a></li>
    <li><a href="#aprendizaje-no-supervisado">Aprendizaje No Supervisado</a></li>
  </ul>

  <ul>
    <li><a href="#estimacion-supervisada">Estimacion Supervisada</a></li>
    <li><a href="#estimacion-no-supervisada">Estimacion No Supervisada</a></li>
  </ul>

  <ul>
    <li><a href="#metricas-de-clasificacion">Metricas de Clasificacion</a>
      <ul>
        <li><a href="#accuracy-score">Accuracy Score</a></li>
        <li><a href="#reporte-de-clasificacion">Reporte de Clasificacion</a></li>
        <li><a href="#confusion-matrix">Confusion Matrix</a></li>
      </ul>
    </li>
    <li><a href="#metricas-de-regresion">Metricas de Regresion</a>
      <ul>
        <li><a href="#error-absoluto-medio-mean-absolute-error">Error absoluto medio (Mean Absolute Error)</a></li>
        <li><a href="#error-cuadratico-medio-mean-squared-error">Error Cuadratico Medio (Mean Squared Error)</a></li>
        <li><a href="#r2-score">R2 Score</a></li>
      </ul>
    </li>
    <li><a href="#metricas-de-clustering">Metricas de Clustering</a>
      <ul>
        <li><a href="#adjusted-rand-index">Adjusted Rand Index</a></li>
        <li><a href="#homogeneidad">Homogeneidad</a></li>
        <li><a href="#v-measure">V-measure</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#grid-search">Grid Search</a></li>
    <li><a href="#optimizacion-aleatoria-de-parametros">Optimizacion Aleatoria de Parametros</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Machine Learning con Scikit Learn</h1>

          <div class="article-style">
            <p>Curso Programacion Analitica</p>
<p>Maestria TIC Linea Ciencia de Datos</p>
<p>Por <a href="https://joserzapata.github.io/" target="_blank" rel="noopener">Jose R. Zapata</a></p>
<script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="joserzapata" data-color="#328cc1" data-emoji="" data-font="Cookie" data-text="Invítame a un Café" data-outline-color="#000000" data-font-color="#ffffff" data-coffee-color="#FFDD00" ></script><br>
<p>Scikit-learn es una biblioteca de código abierto de	 Python que
implementa una gran variedad de algoritmos de aprendizaje automático,
Preprocesamiento, validación cruzada y visualización.</p>
<h1 id="proceso-de-un-proyecto-de-machine-learning">Proceso de un Proyecto de Machine Learning</h1>
<p>En este link encuentran un listado de los pasos a realizar en un proyecto de machine Learning:</p>
<p><a href="https://medium.com/@joserzapata/paso-a-paso-en-un-proyecto-machine-learning-bcdd0939d387">https://medium.com/@joserzapata/paso-a-paso-en-un-proyecto-machine-learning-bcdd0939d387</a></p>
<ul>
<li><a href="https://joserzapata.github.io/post/lista-proyecto-machine-learning/#1-definir-el-problema-y-mirar-el-panorama-general" target="_blank" rel="noopener">1. Definir el problema y mirar el panorama general.</a></li>
<li><a href="https://joserzapata.github.io/post/lista-proyecto-machine-learning/#2-obt%c3%a9ner-los-datos" target="_blank" rel="noopener">2. Obténer los datos</a></li>
<li><a href="https://joserzapata.github.io/post/lista-proyecto-machine-learning/#3-explorar-los-datos-para-obtener-informaci%c3%b3n" target="_blank" rel="noopener">3. Explorar los datos para obtener información.</a></li>
<li><a href="https://joserzapata.github.io/post/lista-proyecto-machine-learning/#4-preparaci%c3%b3n-de-los-datos" target="_blank" rel="noopener">4. Preparación de los datos.</a></li>
<li><a href="https://joserzapata.github.io/post/lista-proyecto-machine-learning/#5-exploraci%c3%b3n-y-selecci%c3%b3n-de-modelos" target="_blank" rel="noopener">5. Exploración y selección de modelos</a></li>
<li><a href="https://joserzapata.github.io/post/lista-proyecto-machine-learning/#6-afinar-los-modelos" target="_blank" rel="noopener">6. Afinar los modelos.</a></li>
<li><a href="https://joserzapata.github.io/post/lista-proyecto-machine-learning/#7-presentacion-de-la-soluci%c3%b3n" target="_blank" rel="noopener">7. Presentacion de la solución.</a></li>
<li><a href="https://joserzapata.github.io/post/lista-proyecto-machine-learning/#8-desplegar-monitorear-y-mantener-el-sistema" target="_blank" rel="noopener">8. Desplegar, monitorear y mantener el sistema.</a></li>
</ul>
<h2 id="pasos-para-la-construccion-y-seleccion-de-un-modelo-de-machine-learning">Pasos para la construccion y seleccion de un Modelo de Machine Learning</h2>
<p><img src="https://miro.medium.com/max/2805/0*IT9aLhgbOVDkMNKM" alt="Construir Modelo"></p>
<ol>
<li>Preparacion de los datos</li>
<li>Division de los datos entre datos de <strong>Entrenamiento</strong> (Para seleccionar el modelo, 80%) y datos de <strong>Test</strong> (para probar el modelo final, 20%)</li>
<li>Se selecciona la medida de Evaluacion segun la aplicacion</li>
<li>Usando solo los datos de <strong>Entrenamiento</strong> se selecciona los mejores modelos utilizando cross validation y comparando sus resultados</li>
<li>Se toman los mejores modelos (1, 2 o 3 dependiendo de su rendimiento) y se ajustan los Hiper Parametros</li>
<li>Se toman los parametros del mejor modelo y se entrena con todos los datos de <strong>Entrenamiento</strong> y se evalua su rendimiento con los datos de <strong>TEST</strong></li>
<li>Si hay un buen resultado se pasa a la etapa de Implementacion (Deployment), en caso contrario segun sea el problema, se prueba con otros modelos o se devuelve a la etapa de Feature Engineering.</li>
</ol>
<h1 id="ejemplo-basico-con-un-solo-modelo">Ejemplo Basico con un solo modelo</h1>
<pre><code class="language-python">## Importar Librerias
from sklearn import neighbors, datasets, preprocessing
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

##  Cargar Dataset
iris = datasets.load_iris()
## Definir cual es la columna de salida
X, y = iris.data[:, :2], iris.target

## Division del dataset en datos de entrenamiento y de prueba
X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=33)

## Standarizacion de los valores
scaler = preprocessing.StandardScaler().fit(X_train)

X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)

## Seleccion del algoritmo de machine learning
knn = neighbors.KNeighborsClassifier(n_neighbors=5)

## Entrenamiento del Modelo
knn.fit(X_train, y_train)

## Prediccion
y_pred = knn.predict(X_test)

# Evaluacion
accuracy_score(y_test, y_pred)
</code></pre>
<pre><code>0.631578947368421
</code></pre>
<h1 id="preprocesamiento-de-datos">Preprocesamiento de Datos</h1>
<h2 id="standardizacion">Standardizacion</h2>
<pre><code class="language-python">from sklearn.preprocessing import StandardScaler
scaler = StandardScaler().fit(X_train)
standardized_X = scaler.transform(X_train)
standardized_X_test = scaler.transform(X_test)
</code></pre>
<h2 id="normalizacion">Normalizacion</h2>
<pre><code class="language-python">from sklearn.preprocessing import Normalizer
scaler = Normalizer().fit(X_train)
normalized_X = scaler.transform(X_train)
normalized_X_test = scaler.transform(X_test)
</code></pre>
<h2 id="binarizacion">Binarizacion</h2>
<pre><code class="language-python">from sklearn.preprocessing import Binarizer
binarizer = Binarizer(threshold=0.0).fit(X)
binary_X = binarizer.transform(X)
</code></pre>
<h2 id="encoding-categorical-features">Encoding Categorical Features</h2>
<pre><code class="language-python">from sklearn.preprocessing import LabelEncoder
enc = LabelEncoder()
y = enc.fit_transform(y)
</code></pre>
<h2 id="imputacion-de-valores-faltantes">Imputacion de valores Faltantes</h2>
<pre><code class="language-python">from sklearn.preprocessing import Imputer
imp = Imputer(missing_values=0, strategy='mean', axis=0)
imp.fit_transform(X_train)
</code></pre>
<h2 id="generacion-de-caracteristicas-polinomiales">Generacion de Caracteristicas Polinomiales</h2>
<pre><code class="language-python">from sklearn.preprocessing import PolynomialFeatures
poly = PolynomialFeatures(5)
oly.fit_transform(X)
</code></pre>
<h2 id="division-datos-de-entrenamiento-y-prueba">Division datos de Entrenamiento y Prueba</h2>
<pre><code class="language-python">from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X,y,random_state=0)
</code></pre>
<h1 id="creacion-de-modelos">Creacion de Modelos</h1>
<h2 id="estimadores-aprendizaje-supervisado">Estimadores Aprendizaje Supervisado</h2>
<h3 id="regresion">Regresion</h3>
<h4 id="regresion-lineal">Regresion lineal</h4>
<pre><code class="language-python">from sklearn.linear_model import LinearRegression
lr = LinearRegression(normalize=True) # los parametros son opcionales
</code></pre>
<h4 id="arboles-de-regresion">Arboles de Regresion</h4>
<pre><code class="language-python">from sklearn.tree import DecisionTreeRegressor
dtr = DecisionTreeRegressor(random_state = 0) # los parametros son opcionales
</code></pre>
<h4 id="regresion-random-forest">Regresion Random Forest</h4>
<pre><code class="language-python">from sklearn.ensemble import RandomForestRegressor
rfr = RandomForestRegressor(n_estimators = 10, random_state = 0) # los parametros son opcionales
</code></pre>
<h3 id="clasificacion">Clasificacion</h3>
<h4 id="regresion-logistica">Regresion Logistica</h4>
<pre><code class="language-python">from sklearn.linear_model import LogisticRegression
lrc = LogisticRegression(random_state = 0) # los parametros son opcionales
</code></pre>
<h4 id="arboles-de-decision">Arboles de decision</h4>
<pre><code class="language-python">from sklearn.tree import DecisionTreeClassifier
dtc = DecisionTreeClassifier(criterion = 'entropy', random_state = 0)  # los parametros son opcionales
</code></pre>
<h4 id="clasificador-random-forest">Clasificador Random Forest</h4>
<pre><code class="language-python">from sklearn.ensemble import RandomForestClassifier
rfc = RandomForestClassifier(n_estimators = 10, criterion = 'entropy', random_state = 0) # los parametros son opcionales
</code></pre>
<h4 id="support-vector-machines-svm">Support Vector Machines (SVM)</h4>
<pre><code class="language-python">from sklearn.svm import SVC
svc = SVC(kernel='linear') # los parametros son opcionales
</code></pre>
<h4 id="kernel-support-vector-machines-svm">Kernel Support Vector Machines (SVM)</h4>
<pre><code class="language-python">from sklearn.svm import SVC
svck = SVC(kernel = 'rbf', random_state = 0) # los parametros son opcionales
</code></pre>
<h4 id="naive-bayes">Naive Bayes</h4>
<pre><code class="language-python">from sklearn.naive_bayes import GaussianNB
gnb = GaussianNB()
</code></pre>
<h4 id="knn">KNN</h4>
<pre><code class="language-python">from sklearn import neighbors
knn = neighbors.KNeighborsClassifier(n_neighbors=5) # los parametros son opcionales
</code></pre>
<h2 id="estimadores-de-aprendizaje-no-supervizado">Estimadores de Aprendizaje No supervizado</h2>
<h3 id="principal-component-analysis-pca">Principal Component Analysis (PCA)</h3>
<pre><code class="language-python">from sklearn.decomposition import PCA
pca = PCA(n_components=0.95)
</code></pre>
<h3 id="k-means">K Means</h3>
<pre><code class="language-python">from sklearn.cluster import KMeans
k_means = KMeans(n_clusters=3, random_state=0)
</code></pre>
<h3 id="hierarchical">Hierarchical</h3>
<pre><code class="language-python">from sklearn.cluster import AgglomerativeClustering
hc = AgglomerativeClustering(n_clusters = 5, affinity = 'euclidean', linkage = 'ward') # los parametros son opcionales
</code></pre>
<h1 id="entrenamiento-de-modelos">Entrenamiento de Modelos</h1>
<h2 id="aprendizaje-supervisado">Aprendizaje Supervisado</h2>
<pre><code class="language-python"># Regresion
lr.fit(X_train, y_train)
dtr.fit(X_train, y_train)
rfr.fit(X_train, y_train)

#Clasificacion
lrc.fit(X_train, y_train)
dtc.fit(X_train, y_train)
rfc.fit(X_train, y_train)
knn.fit(X_train, y_train)
svc.fit(X_train, y_train)
svck.fit(X_train, y_train)
gnb.fit(X_train, y_train)
</code></pre>
<h2 id="aprendizaje-no-supervisado">Aprendizaje No Supervisado</h2>
<pre><code class="language-python">k_means.fit(X_train)
pca_model = pca.fit_transform(X_train)
</code></pre>
<h1 id="prediccion">Prediccion</h1>
<h2 id="estimacion-supervisada">Estimacion Supervisada</h2>
<pre><code class="language-python"># Regresion
y_pred = lr.predict(X_test)
y_pred = dtr.predict(X_test)
y_pred = rfr.predict(X_test)

# Clasificacion
y_pred = svc.predict(X_test)
y_pred = svck.predict(X_test)
y_pred = lrc.predict(X_test)
y_pred = dtc.predict(X_test)
y_pred = rfc.predict(X_test)
y_pred = gnb.predict(X_test)
y_pred = knn.predict_proba(X_test))
</code></pre>
<h2 id="estimacion-no-supervisada">Estimacion No Supervisada</h2>
<pre><code class="language-python">y_pred = k_means.predict(X_test)
y_hc = hc.fit_predict(X_train)
</code></pre>
<h1 id="evaluacion-de-los-modelos">Evaluacion de los Modelos</h1>
<h2 id="metricas-de-clasificacion">Metricas de Clasificacion</h2>
<h3 id="accuracy-score">Accuracy Score</h3>
<pre><code class="language-python">knn.score(X_test, y_test)
from sklearn.metrics import accuracy_score
accuracy_score(y_test, y_pred)
</code></pre>
<h3 id="reporte-de-clasificacion">Reporte de Clasificacion</h3>
<pre><code class="language-python">from sklearn.metrics import classification_report
print(classification_report(y_test, y_pred)))
</code></pre>
<h3 id="confusion-matrix">Confusion Matrix</h3>
<pre><code class="language-python">from sklearn.metrics import confusion_matrix
print(confusion_matrix(y_test, y_pred)))
</code></pre>
<h2 id="metricas-de-regresion">Metricas de Regresion</h2>
<h3 id="error-absoluto-medio-mean-absolute-error">Error absoluto medio (Mean Absolute Error)</h3>
<pre><code class="language-python">from sklearn.metrics import mean_absolute_error
y_true = [3, -0.5, 2])
mean_absolute_error(y_true, y_pred))
</code></pre>
<h3 id="error-cuadratico-medio-mean-squared-error">Error Cuadratico Medio (Mean Squared Error)</h3>
<pre><code class="language-python">from sklearn.metrics import mean_squared_error
mean_squared_error(y_test, y_pred))
</code></pre>
<h3 id="r2-score">R2 Score</h3>
<pre><code class="language-python">from sklearn.metrics import r2_score
r2_score(y_true, y_pred))
</code></pre>
<h2 id="metricas-de-clustering">Metricas de Clustering</h2>
<h3 id="adjusted-rand-index">Adjusted Rand Index</h3>
<pre><code class="language-python">from sklearn.metrics import adjusted_rand_score
adjusted_rand_score(y_true, y_pred))
</code></pre>
<h3 id="homogeneidad">Homogeneidad</h3>
<pre><code class="language-python">from sklearn.metrics import homogeneity_score
homogeneity_score(y_true, y_pred))
</code></pre>
<h3 id="v-measure">V-measure</h3>
<pre><code class="language-python">from sklearn.metrics import v_measure_score
metrics.v_measure_score(y_true, y_pred))
</code></pre>
<h1 id="cross-validation">Cross-Validation</h1>
<pre><code class="language-python">print(cross_val_score(knn, X_train, y_train, cv=4))
print(cross_val_score(lr, X, y, cv=2))
</code></pre>
<h1 id="sintonizacion-del-modelo-hyper---parametrizacion">Sintonizacion del Modelo (Hyper - parametrizacion)</h1>
<h2 id="grid-search">Grid Search</h2>
<pre><code class="language-python">from sklearn.grid_search import GridSearchCV
params = {&quot;n_neighbors&quot;: np.arange(1,3), &quot;metric&quot;: [&quot;euclidean&quot;, &quot;cityblock&quot;]}
grid = GridSearchCV(estimator=knn,param_grid=params)
grid.fit(X_train, y_train)
print(grid.best_score_)
print(grid.best_estimator_.n_neighbors)
</code></pre>
<h2 id="optimizacion-aleatoria-de-parametros">Optimizacion Aleatoria de Parametros</h2>
<pre><code class="language-python"># Ejemplo
from sklearn.grid_search import RandomizedSearchCV
params = {&quot;n_neighbors&quot;: range(1,5), &quot;weights&quot;: [&quot;uniform&quot;, &quot;distance&quot;]}

rsearch = RandomizedSearchCV(estimator=knn,
   param_distributions=params,
   cv=4,
   n_iter=8,
   random_state=5)
rsearch.fit(X_train, y_train)
print(rsearch.best_score_)
</code></pre>
<h1 id="referencias">Referencias</h1>
<p>Tutorial Scikit Learn - <a href="https://scikit-learn.org/stable/tutorial/index.html">https://scikit-learn.org/stable/tutorial/index.html</a></p>
<p>Cheatsheet scikitlearn - <a href="https://datacamp-community-prod.s3.amazonaws.com/5433fa18-9f43-44cc-b228-74672efcd116">https://datacamp-community-prod.s3.amazonaws.com/5433fa18-9f43-44cc-b228-74672efcd116</a></p>
<p><strong>Phd. Jose R. Zapata</strong></p>
<ul>
<li><a href="https://joserzapata.github.io/" target="_blank" rel="noopener">https://joserzapata.github.io/</a></li>
<li><a href="https://twitter.com/joserzapata">https://twitter.com/joserzapata</a></li>
</ul>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Sep 9, 2020</p>

          





          




          


  
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    © 2020
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/shell.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.a38e006a3cab951992b7cf4b14da66b1.js"></script>

    






</body>
</html>
